namespace = anatolia_decisions

## form_k_bithynia_decision
# 0001 - I formed k_bithynia
# 0002 - Someone else formed k_bithynia

## form_k_ionia_decision
# 0003 - I formed k_ionia
# 0004 - Someone else formed k_ionia

##############################
# Form k_bithynia		 	 #
##############################

# I formed k_bithynia
anatolia_decisions.0001 = {
	type = character_event
	title = anatolia_decisions.0001.t
	desc = anatolia_decisions.0001.desc
	theme = realm
	left_portrait = {
		character = scope:k_bithynia_founder
		animation = personality_honorable
	}

	immediate = {
		play_music_cue = "mx_cue_epic_sacral_moment"
		form_k_bithynia_decision_effects = yes

		title:c_astakos = { save_scope_as = astakos }
		title:c_chalkedon = { save_scope_as = chalkedon }
	}
	
	option = { # I choose Astakos
		name = anatolia_decisions.0001.a

		trigger = {
			title:c_astakos.holder = scope:k_bithynia_founder
		}
		title:c_astakos = {
			save_scope_as = new_bithynian_capital
			found_bithynian_capital_scripted_effect = yes
		}
		title:b_astakos_astakos = { 
			save_scope_as = new_bithynian_capital_barony 
			found_bithynian_capital_barony_scripted_effect = yes
		}

		every_player = {
			limit = {
				NOT = { this = scope:k_bithynia_founder }
				is_within_diplo_range = { CHARACTER = scope:k_bithynia_founder }
			}
			trigger_event = anatolia_decisions.0002
		}

		ai_chance = {
			# The AI should prefer this option, since Chalcedon has significantly higher development 
			base = 100
		}
	}
	option = { # I choose Chalkedon
		name = anatolia_decisions.0001.b

		trigger = {
			title:c_chalkedon.holder = scope:k_bithynia_founder
		}
		title:c_chalkedon = {
			save_scope_as = new_bithynian_capital
			found_bithynian_capital_scripted_effect = yes
		}
		title:b_chalkedon_chalkedon = { 
			save_scope_as = new_bithynian_capital_barony 
			found_bithynian_capital_barony_scripted_effect = yes
		}

		every_player = {
			limit = {
				NOT = { this = scope:k_bithynia_founder }
				is_within_diplo_range = { CHARACTER = scope:k_bithynia_founder }
			}
			trigger_event = anatolia_decisions.0002
		}

		ai_chance = {
			# The AI should prefer this option, since Chalcedon has significantly higher development 
			base = 1000
		}
	}
}

# Someone else formed k_bithynia
anatolia_decisions.0002 = {
	type = character_event
	title = anatolia_decisions.0002.t
	desc = anatolia_decisions.0002.desc
	theme = realm
	left_portrait = {
		character = scope:k_bithynia_founder
		animation = personality_honorable
	}

	immediate = {
	}

	option = { # okay
		name = anatolia_decisions.0002.a
	}
}

##############################
# Ionian Kingdom Decisions 	 #
##############################

# I formed an Ionian kingdom
anatolia_decisions.0003 = {
	type = character_event
	title = anatolia_decisions.0003.t
	desc = anatolia_decisions.0003.desc
	theme = realm
	left_portrait = {
		character = scope:ionian_kingdom_founder
		animation = personality_honorable
	}

	immediate = {
		if = {
			limit = { title:k_ionia = { this = scope:ionian_kingdom } }
			form_k_ionia_decision_effects = yes
		}
		else_if = {
			limit = { title:k_troas = { this = scope:ionian_kingdom } }
			form_k_troas_decision_effects = yes
		}
	}

	option = { # okay
		name = anatolia_decisions.0003.a
	}
}

# Someone else formed an Ionian kingdom
anatolia_decisions.0004 = {
	type = character_event
	title = anatolia_decisions.0004.t
	desc = anatolia_decisions.0004.desc
	theme = realm
	left_portrait = {
		character = scope:ionian_kingdom_founder
		animation = personality_honorable
	}

	immediate = {
	}

	option = { # okay
		name = anatolia_decisions.0004.a
	}
}

##############################
# Ionian Revolt Decision 	 #
##############################

# I started the Ionian revolt
anatolia_decisions.0005 = {
	type = character_event
	title = anatolia_decisions.0005.t
	desc = anatolia_decisions.0005.desc
	theme = war
	override_background = {
		event_background = throne_room
	}
	left_portrait = {
		character = scope:ionian_revolt_leader
		animation = war_attacker
	}
	right_portrait = {
		character = scope:ionian_revolt_defender
		animation = war_defender
	}

	immediate = {
		hidden_effect = {
			create_title_and_vassal_change = {
				type = independency
				save_scope_as = change
				add_claim_on_loss = no
			}
			scope:ionian_revolt_leader = {
				change_liege = {
					liege = scope:ionian_revolt_defender
					change = scope:change
				}
			}
			resolve_title_and_vassal_change = scope:change
		}
	}

	option = { # Let's do this!
		name = anatolia_decisions.0005.a

		add_trait = ionian_revolt_leader
		
		start_war = {
			casus_belli = ionian_revolt_cb
			target = scope:ionian_revolt_defender
			target_title = k_ionia
		}
	}

	option = { # I've changed my mind
		name = anatolia_decisions.0005.b
		hidden_effect = {
			create_title_and_vassal_change = {
				type = returned
				save_scope_as = change
				add_claim_on_loss = no
			}
			scope:ionian_revolt_leader = {
				change_liege = {
					liege = scope:ionian_revolt_liege
					change = scope:change
				}
			}
			resolve_title_and_vassal_change = scope:change
		}
		remove_character_flag = attempted_ionian_revolt

		remove_list_global_variable = {
			name = unavailable_unique_decisions
			target = flag:ionian_revolt_decision
		}
	}
}