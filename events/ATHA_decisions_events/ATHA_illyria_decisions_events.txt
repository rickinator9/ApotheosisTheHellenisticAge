namespace = illyria_decisions

##############################
# Form k_liburnia		 	 #
##############################

# I formed k_liburnia
illyria_decisions.0001 = {
	type = character_event
	title = illyria_decisions.0001.t
	desc = illyria_decisions.0001.desc
	theme = realm
	left_portrait = {
		character = scope:k_liburnia_founder
		animation = personality_honorable
	}

	immediate = {
		play_music_cue = "mx_cue_epic_sacral_moment"
		form_k_liburnia_decision_effects = yes
	}
	
	option = { #Centralize the government
		name = illyria_decisions.0001.a
		add_character_flag = founder_centralized_power
	}

	option = { #Maintain the old ways
		name = illyria_decisions.0001.b
		add_character_flag = founder_maintained_status_quo
	}
}

# Someone else formed k_liburnia
illyria_decisions.0002 = {
	type = character_event
	title = illyria_decisions.0002.t
	desc = illyria_decisions.0002.desc
	theme = realm
	left_portrait = {
		character = scope:k_liburnia_founder
		animation = personality_honorable
	}

	option = { 
		name = illyria_decisions.0002.a
	}
}

##############################
# Restore k_paionia borders	 #
##############################

# I restored k_paionia borders
illyria_decisions.0003 = {
	type = character_event
	title = illyria_decisions.0003.t
	desc = illyria_decisions.0003.desc
	theme = realm
	left_portrait = {
		character = scope:k_paionia_restorer
		animation = personality_honorable
	}

	immediate = {
		play_music_cue = "mx_cue_epic_sacral_moment"

		restore_k_paionia_borders_decision_effects = yes

		#Need to save a Greek culture for loc purposes
		culture:macedonian = { save_scope_as = greek_culture }
	}
	
	option = { # Consolidate & resettle the old tribal lands
		name = illyria_decisions.0003.a

		add_character_flag = restorer_is_administrator

		# Create lower Paeonian duchy
		create_d_lower_paionia_scripted_effect = yes

		# Culture conversion modifiers
		every_sub_realm_county = {
			custom = illyria_decisions.0003.a_custom.tt
			limit = {
				NOT = {
					culture = { has_cultural_pillar = heritage_paeonian }
				}
				title_province = { geographical_region = custom_greater_paeonia }
			}
			add_county_modifier = {
				modifier = greater_paeonia_culture_modifier
				years = 50
			}
		}

		# Innovations
		culture = {
			add_random_innovation = culture_group_civic
			add_random_innovation = culture_group_military
		}

		# Cultural acceptance penalty with non-Paeonian cultures in Greater Macedonia 
		custom_tooltip = {
			text = illyria_decisions.0003.a_acceptance.tt
			illyria_decisions.0003.a_acceptance_effect = yes
		}

		#gain bureaucratic tradition/ethos
		#nickame (the settler?) that gives the following effects:
			#stewardship bonus
			#cheaper colony holdings/buildings
			#reduced tyranny penalty
	}
	
	option = { # Posture as an enlightened and cosmopolitan Hellenistic monarch 
		name = illyria_decisions.0003.b

		add_character_flag = restorer_is_cosmopolitan

		# 2 x Civic Innovations
		custom_tooltip = {
			text = illyria_decisions.0003.b_innovations.tt
			culture = {
				add_random_innovation = culture_group_civic
				add_random_innovation = culture_group_civic
			}
		}

		# Cultural acceptance bonus with cultures in your realm
		custom_tooltip = {
			text = illyria_decisions.0003.b_acceptance.tt
			paeonia_culture_acceptance_effect = { VALUE = 5 }
		}

		#nickame that gives the following effects:	
			#different culture vassal opinion boost
			#cheaper guest recruitment
			#learning bonus
		#gain cosmopolitan tradition/ethos

	}

	option = { # I will not rest until every Macedonian dynast lies dead at my feet 
		name = illyria_decisions.0003.c

		add_character_flag = restorer_is_warlike

		#Note: if we end up creating a struggle for the diadochi, this option should cause the Paeonian culture to become involved

		# Get a funky nickname for vanquishing the Macedonians
		set_permanent_nickname_effect = { NICKNAME = nick_macedonicus }

		# Some Military Innovations to prepare you for the upcoming campaigns
		custom_tooltip = {
			text = illyria_decisions.0003.c_innovations.tt
			culture = {
				add_random_innovation = culture_group_military
				add_random_innovation = culture_group_military
			}
		}

		#nickame (diadochos?) that gives the following effects:
			#invasion CB against independent Macedonian rulers
			#cheaper same-culture merc recruitment
			#cheaper MAA upkeep
		#opinion penalty with independent Macedonian rulers
		#one time army spawn
		#cool house/title CoA?
		#very stressful if not ambitious or brave
	}

	option = { # Devastate and plunder Macedonia as revenge for the destruction of Abydon and other Paeonian cities
		name = {
			trigger = {
				has_trait = vengeful
			}
			text = illyria_decisions.0003.d_vengeful
		}
		name = illyria_decisions.0003.d
		flavor = {
			triggered_desc = {
				trigger = {
					has_trait = vengeful
				}
				desc = illyria_decisions.0003.d_flavor
			}
		}

		add_character_flag = restorer_is_vengeful

		#Note: this option is meant to be a shot in the foot, and the consequences will generally outweigh the benefits. A good way for rulers to leave a lasting legacy if they don't mind whether that legacy is positive or not

		trigger = { 
			any_realm_county = { culture = culture:macedonian } 
		}

		# Get a funky nickname for vanquishing the Macedonians
		set_permanent_nickname_effect = { NICKNAME = nick_macedonicus }

		add_dread = major_dread_gain

		culture:macedonian = {
			save_scope_as = plunder_victim
			change_cultural_acceptance = {
				target = root.culture
				value = -30
				desc = cultural_acceptance_loss_plundered_lands
			}
		}

		every_realm_county = {
			limit = { culture = culture:macedonian }
			custom = every_macedonian_county

			#For calculating loot
			add_to_list = sacked_counties

			#Hefty penalty to control and development
			change_development_level = -3
			change_county_control = -50

			#Temporary modifier that reduces popular opinion and kills development
			add_county_modifier = { 
				modifier = recently_devastated_modifier
				years = 30 
			}
			#Permanent crippling modifier
			add_county_modifier = { modifier = stripped_bare_modifier }

			#Chance of province culture flipping
			random = {
				chance = 20
				set_county_culture = root.culture
			}

			#Vassals aren't happy that you've looted their lands
			holder = {
				limit = { NOT = this:root }
				custom_description_no_bullet = {
					text = macedonian_county_holder
				}
				add_opinion = {
					target = root
					modifier = plundered_lands_opinion
				}
			}
		}

		add_gold = illyria_decisions.0003.d_loot

		stress_impact = {
			base = major_stress_impact_gain
			forgiving = medium_stress_impact_gain
			just = medium_stress_impact_gain
			compassionate = medium_stress_impact_gain
			content = minor_stress_impact_gain
			callous = medium_stress_impact_loss
			arbitrary = medium_stress_impact_loss
			greedy = medium_stress_impact_loss
			vengeful = major_stress_impact_loss
			sadistic = massive_stress_impact_loss
		}

		#TODO: incorporate into memories mechanics
	}

	option = { # Claim that you were Greek all along
		name = illyria_decisions.0003.e

		flavor = illyria_decisions.0003.e.tt

		#trigger = {
		#	knows_language = language_greek
		#	has_court_language = language_greek
		#}
		add_internal_flag = special

		# Get a nickname to show off your Philhellenism
		set_permanent_nickname_effect = { NICKNAME = nick_philhellene }

		duel = {
			skill = diplomacy
			value = medium_skill_rating
			30 = {  
				desc = illyria_decisions.0003.e_success
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				add_character_flag = restorer_philhellene_success

				# Get 5 random Greek innovations
				custom_tooltip = {
					text = illyria_decisions.0003.e_success_innovations.tt
					paionia_vassal_innovations_effect = yes
				}

				# Get random level 1 ancestry modifier
				custom_tooltip = {
					text = illyria_decisions.0003.e_success_ancestry.tt
					ancestry_random_modifier_effect = { LEVEL = 1 }
				}

				# Your culture gets Greek language (if it doesn't already) and heritage
				custom_tooltip = {
					text = illyria_decisions.0003.e_success_culture_pillars.tt
					culture = {
						set_culture_pillar = heritage_greek
						set_culture_pillar = language_greek
					}
				}
	
				# Paionia becomes a de-jure Greek territory
				title:k_paionia = { set_de_jure_liege_title = title:e_hellas }
			}
			70 = {
				desc = illyria_decisions.0003.e_failure
				compare_modifier = {
					value = scope:duel_value
					multiplier = -1.5
					min = -49
				}
				add_character_flag = restorer_philhellene_failure

				# Still get 3 random Greek innovations
				custom_tooltip = {
					text = illyria_decisions.0003.e_failure_innovations.tt
					paionia_vassal_innovations_effect = yes
				}

				# Cultural acceptance bonus with Greek cultures in your realm
				custom_tooltip = {
					text = illyria_decisions.0003.e_failure_acceptance.tt
					paeonia_culture_acceptance_effect = { VALUE = 10 }
				}
			}
		}
	}
}

# Someone else formed k_liburnia
illyria_decisions.0004 = {
	type = character_event
	title = illyria_decisions.0004.t
	desc = illyria_decisions.0004.desc
	theme = realm
	left_portrait = {
		character = scope:k_liburnia_founder
		animation = personality_honorable
	}

	option = { 
		name = illyria_decisions.0004.a
	}
}