namespace = ATHA_nickname

# Assign an epithet to a ruler that can have an epithet when they succeed to an independent throne.
ATHA_nickname.0001 = {
	type = character_event
	title = ATHA_nickname.0001.t
	desc = ATHA_nickname.0001.desc
	theme = crown
	left_portrait = root

	trigger = {
		can_get_epithet_trigger = yes
		NOT = { has_character_flag = prompted_to_choose_epithet } # Prevent getting the event multiple times when inheriting a lot of titles.
	}

	immediate = {
		save_epithet_suggestion = { OPTION = option1 }
		save_epithet_suggestion = { OPTION = option2 }
		save_epithet_suggestion = { OPTION = option3 }

		add_character_flag = prompted_to_choose_epithet

		# Councillor used in localisation.
		random_councillor = {
			save_scope_as = councillor
		}
	}

	option = {
		name = ATHA_nickname.0001.opt_the_asian
		trigger = {
			OR = {
				scope:option1 = flag:the_asian
				scope:option2 = flag:the_asian
				scope:option3 = flag:the_asian
			}
		}
		ai_chance = {
			base = 10

			modifier = {
				factor = 1.1
				has_trait = greedy
			}
			modifier = {
				factor = 1.2
				has_trait = gregarious # Willing to show their acculturisation to others.
			}
			modifier = {
				factor = 1.2
				OR = {
					has_trait = education_diplomacy
					has_trait = education_learning
				}
			}
			modifier = { # This character's ancestors used this particular nickname.
				factor = 1.2
				any_close_family_member = {
					OR = {
						is_parent_of = root
						is_grandparent_of = root
						is_great_grandparent_of = root
					}
					has_nickname = epithet_the_asian
				}
			}
		}

		set_epithet_effect = { EPITHET = epithet_the_asian }
	}

	option = {
		name = ATHA_nickname.0001.opt_the_autocrat
		trigger = {
			OR = {
				scope:option1 = flag:the_autocrat
				scope:option2 = flag:the_autocrat
				scope:option3 = flag:the_autocrat
			}
		}
		ai_chance = {
			base = 10

			modifier = {
				factor = 1.3
				has_trait = ambitious
			}
			modifier = {
				factor = 1.1
				has_trait = diligent
			}
			modifier = {
				factor = 1.05
				has_trait = greedy
			}
			modifier = {
				factor = 1.2
				has_trait = education_stewardship
			}
			modifier = {
				factor = 1.1
				has_trait = august
			}
			modifier = {
				factor = 1.1
				has_trait = overseer
			}
			modifier = { # This character's ancestors used this particular nickname.
				factor = 1.2
				any_close_family_member = {
					OR = {
						is_parent_of = root
						is_grandparent_of = root
						is_great_grandparent_of = root
					}
					OR = {
						has_nickname = epithet_the_autocrat
						has_nickname = nick_the_autocrat
					}
				}
			}
		}

		set_epithet_effect = { EPITHET = epithet_the_autocrat }
	}

	option = {
		name = ATHA_nickname.0001.opt_the_victorious
		trigger = {
			OR = {
				scope:option1 = flag:the_victorious
				scope:option2 = flag:the_victorious
				scope:option3 = flag:the_victorious
			}
		}
		ai_chance = {
			base = 10

			modifier = {
				factor = 1.1
				has_trait = brave
			}
			modifier = {
				factor = 1.05
				has_trait = wrathful
			}
			modifier = {
				factor = 1.05
				has_trait = ambitious
			}
			modifier = {
				factor = 1.2
				has_trait = education_martial
			}
			modifier = {
				factor = 1.1
				has_trait = strategist
			}
			modifier = { # This character's ancestors used this particular nickname.
				factor = 1.2
				any_close_family_member = {
					OR = {
						is_parent_of = root
						is_grandparent_of = root
						is_great_grandparent_of = root
					}
					OR = {
						has_nickname = epithet_the_victorious
						has_nickname = nick_the_victorious
					}
				}
			}
		}

		set_epithet_effect = { EPITHET = epithet_the_victorious }
	}

	option = {
		name = ATHA_nickname.0001.opt_the_beautifully_triumphant
		trigger = {
			OR = {
				scope:option1 = flag:the_beautifully_triumphant
				scope:option2 = flag:the_beautifully_triumphant
				scope:option3 = flag:the_beautifully_triumphant
			}
		}
		ai_chance = {
			base = 10

			modifier = {
				factor = 1.1
				has_trait = brave
			}
			modifier = {
				factor = 1.05
				has_trait = wrathful
			}
			modifier = {
				factor = 1.05
				has_trait = ambitious
			}
			modifier = {
				factor = 1.2
				has_trait = education_martial
			}
			modifier = {
				factor = 1.1
				has_trait = august
			}
			modifier = { # This character's ancestors used this particular nickname.
				factor = 1.2
				any_close_family_member = {
					OR = {
						is_parent_of = root
						is_grandparent_of = root
						is_great_grandparent_of = root
					}
					OR = {
						has_nickname = epithet_the_beautifully_triumphant
						has_nickname = nick_the_beautifully_triumphant
					}
				}
			}
		}

		set_epithet_effect = { EPITHET = epithet_the_beautifully_triumphant }
	}

	option = {
		name = ATHA_nickname.0001.opt_the_benefactor
		trigger = {
			OR = {
				scope:option1 = flag:the_benefactor
				scope:option2 = flag:the_benefactor
				scope:option3 = flag:the_benefactor
			}
		}
		ai_chance = {
			base = 10

			modifier = {
				factor = 1.2
				has_trait = diligent
			}
			modifier = {
				factor = 1.1
				has_trait = generous
			}
			modifier = {
				factor = 1.1
				has_trait = gregarious
			}
			modifier = {
				factor = 1.1
				has_trait = compassionate
			}
			modifier = {
				factor = 1.2
				has_trait = education_diplomacy
			}
			modifier = {
				factor = 1.05
				has_trait = overseer
			}
			modifier = {
				factor = 1.05
				has_trait = administrator
			}
			modifier = {
				factor = 1.1
				has_trait = architect
			}
			modifier = { # This character's ancestors used this particular nickname.
				factor = 1.2
				any_close_family_member = {
					OR = {
						is_parent_of = root
						is_grandparent_of = root
						is_great_grandparent_of = root
					}
					OR = {
						has_nickname = epithet_the_benefactor
						has_nickname = nick_the_benefactor
					}
				}
			}
		}

		set_epithet_effect = { EPITHET = epithet_the_benefactor }
	}

	option = {
		name = ATHA_nickname.0001.opt_the_divine
		trigger = {
			OR = {
				scope:option1 = flag:the_divine
				scope:option2 = flag:the_divine
				scope:option3 = flag:the_divine
			}
		}
		ai_chance = {
			base = 10

			modifier = {
				factor = 1.1
				has_trait = ambitious
			}
			modifier = {
				factor = 1.2
				has_trait = arrogant
			}
			modifier = {
				factor = 1.25
				has_trait = zealous
			}
			modifier = {
				factor = 1.2
				has_trait = education_learning
			}
			modifier = { # Religions that do not allow people to be deified should not choose this as a title, unless ROOT is insane of course!
				factor = 0
				NOR = {
					has_trait = lunatic_1
					has_trait = lunatic_genetic
					faith = faith:alexandrian_faith # TODO: Tie this to a tenet once we have a Apotheosis tenet.
					faith = faith:soterism_faith
				}
			}
			modifier = {
				factor = 1.5
				num_virtuous_traits >= 3
			}
			modifier = { # This character's ancestors used this particular nickname.
				factor = 1.2
				any_close_family_member = {
					OR = {
						is_parent_of = root
						is_grandparent_of = root
						is_great_grandparent_of = root
					}
					OR = {
						has_nickname = epithet_the_divine
						has_nickname = nick_the_divine
					}
				}
			}
		}

		set_epithet_effect = { EPITHET = epithet_the_divine }
	}

	option = {
		name = ATHA_nickname.0001.opt_the_divine_manifest
		trigger = {
			OR = {
				scope:option1 = flag:the_divine_manifest
				scope:option2 = flag:the_divine_manifest
				scope:option3 = flag:the_divine_manifest
			}
		}
		ai_chance = {
			base = 10

			modifier = {
				factor = 1.1
				has_trait = ambitious
			}
			modifier = {
				factor = 1.2
				has_trait = arrogant
			}
			modifier = {
				factor = 1.25
				has_trait = zealous
			}
			modifier = {
				factor = 1.2
				has_trait = education_learning
			}
			modifier = { # Religions that do not allow people to be deified should not choose this as a title, unless ROOT is insane of course!
				factor = 0
				NOR = {
					has_trait = lunatic_1
					has_trait = lunatic_genetic
					faith = faith:alexandrian_faith # TODO: Tie this to a tenet once we have a Apotheosis tenet.
					faith = faith:soterism_faith
				}
			}
			modifier = {
				factor = 1.5
				num_virtuous_traits >= 3
			}
			modifier = { # This character's ancestors used this particular nickname.
				factor = 1.2
				any_close_family_member = {
					OR = {
						is_parent_of = root
						is_grandparent_of = root
						is_great_grandparent_of = root
					}
					has_nickname = epithet_the_divine_manifest
				}
			}
		}

		set_epithet_effect = { EPITHET = epithet_the_divine_manifest }
	}

	option = {
		name = ATHA_nickname.0001.opt_the_father_loving
		trigger = {
			OR = {
				scope:option1 = flag:the_father_loving
				scope:option2 = flag:the_father_loving
				scope:option3 = flag:the_father_loving
			}
		}
		ai_chance = {
			base = 10

			modifier = { # These familial nicknames were very common in the Greek world.
				factor = 1.5
				uses_greek_for_nickname_localization_trigger = yes
			}
			modifier = { # The character had exceedingly positive relations with their father.
				factor = 1.5
				OR = {
					has_relation_friend = father
					has_relation_best_friend = father
					has_relation_lover = father
					has_relation_soulmate = father
				}
			}
			modifier = { # Will never assume this epithet if this character had exceedingly bad relations with their father or if they are deceitful.
				factor = 0
				NOT = { has_trait = deceitful }
				OR = {
					has_relation_rival = father
					has_relation_nemesis = father
				}
			}
			modifier = {
				factor = 1.1
				has_trait = gregarious # More likely to establish family ties.
			}
			modifier = {
				factor = 1.1
				has_trait = compassionate
			}
			modifier = {
				factor = 1.2
				has_trait = education_diplomacy
			}
			modifier = {
				factor = 1.2
				has_trait = family_first
			}
			modifier = { # This character's ancestors used this particular nickname.
				factor = 1.2
				any_close_family_member = {
					OR = {
						is_parent_of = root
						is_grandparent_of = root
						is_great_grandparent_of = root
					}
					OR = {
						has_nickname = epithet_the_father_loving
						has_nickname = nick_the_father_loving
					}
				}
			}
		}

		set_epithet_effect = { EPITHET = epithet_the_father_loving }
	}

	option = {
		name = ATHA_nickname.0001.opt_the_generous
		trigger = {
			OR = {
				scope:option1 = flag:the_generous
				scope:option2 = flag:the_generous
				scope:option3 = flag:the_generous 
			}
		}
		ai_chance = {
			base = 10

			modifier = {
				factor = 1.5
				has_trait = generous
			}
			modifier = {
				factor = 1.2
				has_trait = compassionate
			}
			modifier = {
				factor = 1.2
				has_trait = education_diplomacy
			}
			modifier = { # This character's ancestors used this particular nickname.
				factor = 1.2
				any_close_family_member = {
					OR = {
						is_parent_of = root
						is_grandparent_of = root
						is_great_grandparent_of = root
					}
					OR = {
						has_nickname = epithet_the_generous
						has_nickname = nick_the_generous
					}
				}
			}
		}

		set_epithet_effect = { EPITHET = epithet_the_generous }
	}

	option = {
		name = ATHA_nickname.0001.opt_the_just
		trigger = {
			OR = {
				scope:option1 = flag:the_just
				scope:option2 = flag:the_just
				scope:option3 = flag:the_just
			}
		}
		ai_chance = {
			base = 10

			modifier = {
				factor = 1.2
				has_trait = diligent
			}
			modifier = {
				factor = 1.05
				has_trait = generous
			}
			modifier = {
				factor = 1.05
				has_trait = gregarious
			}
			modifier = {
				factor = 1.25
				has_trait = honest
			}
			modifier = {
				factor = 1.5
				has_trait = just
			}
			modifier = {
				factor = 1.2
				has_trait = education_stewardship
			}
			modifier = {
				factor = 1.05
				has_trait = administrator
			}
			modifier = { # This character's ancestors used this particular nickname.
				factor = 1.2
				any_close_family_member = {
					OR = {
						is_parent_of = root
						is_grandparent_of = root
						is_great_grandparent_of = root
					}
					OR = {
						has_nickname = epithet_the_just
						has_nickname = nick_the_just
					}
				}
			}
		}

		set_epithet_effect = { EPITHET = epithet_the_just }
	}

	option = {
		name = ATHA_nickname.0001.opt_the_mother_loving
		trigger = {
			OR = {
				scope:option1 = flag:the_mother_loving
				scope:option2 = flag:the_mother_loving
				scope:option3 = flag:the_mother_loving
			}
		}
		ai_chance = {
			base = 10

			modifier = { # These familial nicknames were very common in the Greek world.
				factor = 1.5
				uses_greek_for_nickname_localization_trigger = yes
			}
			modifier = { # The character had exceedingly positive relations with their mother.
				factor = 1.5
				OR = {
					has_relation_friend = mother
					has_relation_best_friend = mother
					has_relation_lover = mother
					has_relation_soulmate = mother
				}
			}
			modifier = { # Will never assume this epithet if this character had exceedingly bad relations with their mother or if they are deceitful.
				factor = 0
				NOT = { has_trait = deceitful }
				OR = {
					has_relation_rival = mother
					has_relation_nemesis = mother
				}
			}
			modifier = {
				factor = 1.1
				has_trait = gregarious # More likely to establish family ties.
			}
			modifier = {
				factor = 1.1
				has_trait = compassionate
			}
			modifier = {
				factor = 1.2
				has_trait = education_diplomacy
			}
			modifier = {
				factor = 1.2
				has_trait = family_first
			}
			modifier = { # This character's ancestors used this particular nickname.
				factor = 1.2
				any_close_family_member = {
					OR = {
						is_parent_of = root
						is_grandparent_of = root
						is_great_grandparent_of = root
					}
					OR = {
						has_nickname = epithet_the_mother_loving
						has_nickname = nick_the_mother_loving
					}
				}
			}
		}

		set_epithet_effect = { EPITHET = epithet_the_mother_loving }
	}

	option = {
		name = ATHA_nickname.0001.opt_the_pious
		trigger = {
			OR = {
				scope:option1 = flag:the_pious
				scope:option2 = flag:the_pious
				scope:option3 = flag:the_pious
			}
		}
		ai_chance = {
			base = 10

			modifier = {
				factor = 1.5
				has_trait = zealous
			}
			modifier = {
				factor = 1.2
				has_trait = education_learning
			}
			modifier = {
				factor = 1.2
				has_trait = theologian
			}
			modifier = {
				factor = 1.25
				num_virtuous_traits >= 1
			}
			modifier = { # This character's ancestors used this particular nickname.
				factor = 1.2
				any_close_family_member = {
					OR = {
						is_parent_of = root
						is_grandparent_of = root
						is_great_grandparent_of = root
					}
					OR = {
						has_nickname = epithet_the_pious
						has_nickname = nick_the_pious
					}
				}
			}
		}

		set_epithet_effect = { EPITHET = epithet_the_pious }
	}

	option = {
		name = ATHA_nickname.0001.opt_the_saviour
		trigger = {
			OR = {
				scope:option1 = flag:the_saviour
				scope:option2 = flag:the_saviour
				scope:option3 = flag:the_saviour
			}
		}
		ai_chance = {
			base = 10

			modifier = {
				factor = 1.1
				has_trait = brave
			}
			modifier = {
				factor = 1.2
				has_trait = wrathful # Sort of a slight xenophobic behavior.
			}
			modifier = {
				factor = 1.1
				has_trait = arrogant # Arrogant people likely hate barbarians.
			}
			modifier = {
				factor = 1.1
				has_trait = zealous # Those barbs probably have a different faith, otherwise they wouldn't be barbs.
			}
			modifier = {
				factor = 1.2
				has_trait = education_martial
			}
			modifier = {
				factor = 1.05
				has_trait = theologian
			}
			modifier = { # This character's ancestors used this particular nickname.
				factor = 1.2
				any_close_family_member = {
					OR = {
						is_parent_of = root
						is_grandparent_of = root
						is_great_grandparent_of = root
					}
					OR = {
						has_nickname = epithet_the_saviour
						has_nickname = nick_the_saviour
					}
				}
			}
		}

		set_epithet_effect = { EPITHET = epithet_the_saviour }
	}

	option = {
		name = ATHA_nickname.0001.opt_the_sibling_loving
		trigger = {
			OR = {
				scope:option1 = flag:the_sibling_loving
				scope:option2 = flag:the_sibling_loving
				scope:option3 = flag:the_sibling_loving
			}
		}
		ai_chance = {
			base = 10

			modifier = { # These familial nicknames were very common in the Greek world.
				factor = 1.5
				uses_greek_for_nickname_localization_trigger = yes
			}
			modifier = { # The character had exceedingly positive relations with one of their siblings.
				factor = 1.5
				any_sibling = {
					OR = {
						has_relation_friend = root
						has_relation_best_friend = root
						has_relation_lover = root
						has_relation_soulmate = root
					}
				}
			}
			modifier = { # Will never assume this epithet if this character had exceedingly bad relations with one of their siblings or if they are deceitful.
				factor = 0
				NOT = { has_trait = deceitful }
				any_sibling = {
					OR = {
						has_relation_rival = root
						has_relation_nemesis = root
					}
				}
			}
			modifier = {
				factor = 1.1
				has_trait = gregarious # More likely to establish family ties.
			}
			modifier = {
				factor = 1.1
				has_trait = compassionate
			}
			modifier = {
				factor = 1.2
				has_trait = education_diplomacy
			}
			modifier = {
				factor = 1.2
				has_trait = family_first
			}
			modifier = { # This character's ancestors used this particular nickname.
				factor = 1.2
				any_close_family_member = {
					OR = {
						is_parent_of = root
						is_grandparent_of = root
						is_great_grandparent_of = root
					}
					OR = {
						has_nickname = epithet_the_sibling_loving
						has_nickname = nick_the_sibling_loving
					}
				}
			}
		}

		set_epithet_effect = { EPITHET = epithet_the_sibling_loving }
	}

	option = {
		name = ATHA_nickname.0001.opt_the_victor
		trigger = {
			OR = {
				scope:option1 = flag:the_victor
				scope:option2 = flag:the_victor
				scope:option3 = flag:the_victor
			}
		}
		ai_chance = {
			base = 10

			modifier = {
				factor = 1.1
				has_trait = brave
			}
			modifier = {
				factor = 1.05
				has_trait = wrathful
			}
			modifier = {
				factor = 1.05
				has_trait = ambitious
			}
			modifier = {
				factor = 1.2
				has_trait = education_martial
			}
			modifier = {
				factor = 1.1
				has_trait = strategist
			}
			modifier = { # This character's ancestors used this particular nickname.
				factor = 1.2
				any_close_family_member = {
					OR = {
						is_parent_of = root
						is_grandparent_of = root
						is_great_grandparent_of = root
					}
					OR = {
						has_nickname = epithet_the_victor
						has_nickname = nick_the_victor
					}
				}
			}
		}

		set_epithet_effect = { EPITHET = epithet_the_victor }
	}

	option = {
		name = ATHA_nickname.0001.opt_the_wealthy
		trigger = {
			OR = {
				scope:option1 = flag:the_wealthy
				scope:option2 = flag:the_wealthy
				scope:option3 = flag:the_wealthy
			}
		}
		ai_chance = {
			base = 10

			modifier = {
				factor = 1.5
				has_trait = greedy
			}
			modifier = {
				factor = 1.2
				has_trait = education_stewardship
			}
			modifier = { # This character's ancestors used this particular nickname.
				factor = 1.2
				any_close_family_member = {
					OR = {
						is_parent_of = root
						is_grandparent_of = root
						is_great_grandparent_of = root
					}
					OR = {
						has_nickname = epithet_the_wealthy
						has_nickname = nick_the_wealthy
					}
				}
			}
		}

		set_epithet_effect = { EPITHET = epithet_the_wealthy }
	}

	option = {
		name = ATHA_nickname.0001.opt_the_well_born
		trigger = {
			OR = {
				scope:option1 = flag:the_well_born
				scope:option2 = flag:the_well_born
				scope:option3 = flag:the_well_born
			}
		}
		ai_chance = {
			base = 10

			modifier = {
				factor = 1.5
				has_trait = arrogant
			}
			modifier = {
				factor = 1.2
				has_trait = education_intrigue
			}
			modifier = { # If they have good genetic traits and are arrogant, they will certainly want to showcase this to the world.
				factor = 1.5
				has_trait = arrogant
				num_of_good_genetic_traits > 0
			}
			modifier = { # This character's ancestors used this particular nickname.
				factor = 1.2
				any_close_family_member = {
					OR = {
						is_parent_of = root
						is_grandparent_of = root
						is_great_grandparent_of = root
					}
					OR = {
						has_nickname = epithet_the_well_born
						has_nickname = nick_the_well_born
					}
				}
			}
		}

		set_epithet_effect = { EPITHET = epithet_the_well_born }
	}

	option = {
		name = ATHA_nickname.0001.opt_no_epithet
		ai_chance = {
			base = 0 # AI should never pick this unless any of the traits are applicable.

			modifier = {
				add = 10
				has_trait = content # Doesn't care about an epithet.
			}
			modifier = {
				add = 5
				has_trait = fickle # Can't choose between the others.
			}
			modifier = {
				add = 5
				has_trait = humble # May see an epithet as unnecessary.
			}
			modifier = { # They hate themselves, so do they really deserve an epithet?
				add = 5
				OR = {
					has_trait = depressed_1
					has_trait = depressed_genetic
				}
			}
			modifier = {
				add = 10
				has_trait = bastard_founder
			}
		}
		add_character_flag = refused_epithet
	}
}