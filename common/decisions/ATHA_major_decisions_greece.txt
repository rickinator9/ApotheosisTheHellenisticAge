##############################
# Form k_lakedaimon		 	 #
##############################

form_k_lakedaimon_decision = { # aka: Restore the Spartan Hegemony
	picture = "gfx/interface/illustrations/decisions/decision_spartan.dds"
	major = yes

	ai_check_interval = 120

	desc = form_k_lakedaimon_decision_desc
	selection_tooltip = form_k_lakedaimon_decision_tooltip

	is_shown = {
		has_culture = culture:dorian_south
		has_government = city_state_spartan_government
		highest_held_title_tier <= tier_duchy
		title:k_lakedaimon = { is_titular = yes }
	}

	is_valid = {
		is_independent_ruler = yes
		has_primary_title = title:d_lakedaimon
		completely_controls = title:d_lakedaimon
		completely_controls = title:d_messenia
		completely_controls = title:c_megalopolis # part of Megalopolis' purpose was to keep Sparta at bay
		completely_controls = title:c_thyreatis # given to the Argives by Philip II 
	}

	is_valid_showing_failures_only = {
		
	}

	effect = {
		save_scope_as = k_lakedaimon_founder

		show_as_tooltip = { form_k_lakedaimon_decision_effects = yes } # Actually applied in greece_decisions.0001 - prestige, de-jure, title etc
		custom_tooltip = form_k_lakedaimon_decision_effect_tooltip

		#Events
		trigger_event = greece_decisions.0001 # Ruler gets a choice of whether or not to enslave Messenia
	}

	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 100
	}
}

##############################
# Form k_athenai		 	 #
##############################

form_k_athenai_decision = { # aka: Establish the Third Naval League
	picture = "gfx/interface/illustrations/decisions/decision_spartan.dds"
	major = yes

	ai_check_interval = 120

	desc = form_k_athenai_decision_desc
	selection_tooltip = form_k_athenai_decision_tooltip

	is_shown = {
		has_culture = culture:athenian
		government_has_flag = is_city_state_government
		highest_held_title_tier <= tier_duchy
		title:k_athenai = { exists = no }
	}

	is_valid = {
		is_independent_ruler = yes
		has_primary_title = title:d_attike
		completely_controls = title:d_attike
		OR = { # TODO: this whole section could probably be done in a much nicer and more efficient way!
			AND = { 
				has_title = title:d_kyklades
				OR = { 
					has_title = title:d_doris
					has_title = title:d_ionia
					has_title = title:d_aiolis
					has_title = title:d_troas
				}
			}
			AND = {
				has_title = title:d_euboia
				OR = {
					AND = { 
						has_title = title:d_apsinthis
						has_title = title:d_briantike
					}
					AND = { 
						has_title = title:d_apsinthis
						has_title = title:d_parastrymonia
					}
					AND = { 
						has_title = title:d_apsinthis
						has_title = title:d_chalkidike
					}
					AND = { 
						has_title = title:d_briantike
						has_title = title:d_parastrymonia
					}
					AND = { 
						has_title = title:d_briantike
						has_title = title:d_chalkidike
					}
					AND = { 
						has_title = title:d_parastrymonia
						has_title = title:d_chalkidike
					}
				}
			}
		}
	}

	is_valid_showing_failures_only = {
		
	}

	effect = {
	
		# Create kingdom title
		create_title_and_vassal_change = {
			type = created
			save_scope_as = change
			add_claim_on_loss = no
		}
		title:k_athenai = {
			change_title_holder = {
				holder = root
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = scope:change

		#hidden_effect = {
		#	title:k_athenai = { set_de_jure_liege_title = title:e_hellas }
		#}

		add_prestige = k_athenai_prestige_multiplier

		save_scope_as = k_athenai_founder

		show_as_tooltip = { form_k_athenai_decision_effects = yes } # Actually applied in greece_decisions.0003 - prestige, title etc
		custom_tooltip = form_k_athenai_decision_effect_tooltip
	}

	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 100
	}
}