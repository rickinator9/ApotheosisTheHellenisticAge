##############################
# Form k_bithynia		 	 #
##############################

# TODO: (Probably excessive, but worth considering) Character gains philhellene modifier, boosting their relationship with Greek characters as long as their culture is non-Greek (is this even possible?) - in the future it may be worth looking into whether a similar modifier could be applied to dynasties that became considerably Hellenised, though this should be invalidated for characters who adopt Greek culture. The ideal ultimately would be to have this work dynamically with any culture to reflect peer polity interaction

form_k_bithynia_decision = { # aka: Consolidate the Kingdom of Bithynia
	picture = "gfx/interface/illustrations/decisions/decision_dynasty_house.dds"
	major = yes

	ai_check_interval = 120

	desc = form_k_bithynia_decision_desc
	selection_tooltip = form_k_bithynia_decision_tooltip

	is_shown = {
		has_culture = culture:bithynian
		highest_held_title_tier <= tier_duchy
		OR = {
			has_government = feudal_government
			has_government = clan_government
		}
		#Must not already exist or have de jure territory
		title:k_bithynia = { 
			is_titular = yes
			is_title_created = no
		}
	}

	is_valid = {
		# Must be independent
		is_independent_ruler = yes

		# Should have a decent prestige level
		prestige_level >= high_prestige_level

		# Must control d_bithynia, and at least one of the other component duchies
		has_primary_title = title:d_bithynia
		OR = {
			has_title = title:d_mariandynia
			has_title = title:d_askania
			has_title = title:d_sangarios
		}
		# Must personally hold a city in d_bithynia that can serve as the new capital
		OR = {			
			has_title = title:c_astakos
			has_title = title:c_chalkedon
		}
		# Should also have asserted dominance over at least one of the other main cities in the broader region
		OR = {
			completely_controls = title:c_nikaia
			completely_controls = title:c_herakleia_pontica
		}
	}

	is_valid_showing_failures_only = {
		is_capable_adult = yes
		is_imprisoned = no
		is_at_war = no
	}

	effect = {
		save_scope_as = k_bithynia_founder

		show_as_tooltip = { form_k_bithynia_decision_effects = yes } # Actually applied in anatolia_decisions.0001 - de-jure, title etc
		custom_tooltip = form_k_bithynia_decision_effect_tooltip

		#Events
		trigger_event = anatolia_decisions.0001 # Ruler invests in new capital
	}

	cost = {
		gold = 500
		prestige = 1000
	}

	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 100
	}
}

##############################
# k_ionia Decisions		 	 #
##############################
# These are identical aside from requirements and flavour
# - form_k_ionia_decision
# - liberate_k_ionia_decision

form_k_ionia_decision = { # aka: Unite the poleis of the Ionian coast
	picture = "gfx/interface/illustrations/decisions/decision_dynasty_house.dds"
	major = yes

	ai_check_interval = 120

	desc = form_k_ionia_decision_desc

	selection_tooltip = form_k_ionia_decision_tooltip

	is_shown = {
		OR = {
			has_culture = culture:dorian
			has_culture = culture:ionian
			has_culture = culture:aeolian
		}

		capital_province = { geographical_region = custom_ionia }

		highest_held_title_tier <= tier_duchy

		#Must not already exist or have de jure territory
		title:k_ionia = { 
			is_titular = yes
			is_title_created = no
		}
	}

	is_valid = {
		is_independent_ruler = yes

		#Primary title must be one of the Ionian duchies
		custom_description = {
			text = form_k_ionia_decision.primary_duchy.tt
			OR = {
				has_primary_title = title:d_aiolis
				has_primary_title = title:d_ionia
				has_primary_title = title:d_doris
			}
		}

		#Must have city-state or coalition government
		OR = {
			has_city_state_government = yes
			has_coalition_government = yes
		}

		#Has to control the western coast of Asia Minor
		completely_controls_region = custom_ionia
	}

	is_valid_showing_failures_only = {
		is_capable_adult = yes
		is_imprisoned = no
		is_at_war = no
	}

	effect = {
		save_scope_as = ionian_kingdom_founder
		title:k_ionia = { save_scope_as = ionian_kingdom }

		show_as_tooltip = { form_k_ionia_decision_effects = yes } # Actually applied in anatolia_decisions.0003 - prestige, de-jure, title etc
		custom_tooltip = form_k_ionia_decision_effects.de_jure.tt

		#Events
		trigger_event = anatolia_decisions.0003

		#Notify other players
		every_player = {
			limit = {
				NOT = { this = root }
				is_within_diplo_range = { CHARACTER = root }
			}
			trigger_event = anatolia_decisions.0004
		}
	}

	cost = {
		gold = 300
	}

	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 100
	}
}

liberate_k_ionia_decision = { # aka: Liberate the Ionian coast
	picture = "gfx/interface/illustrations/decisions/decision_dynasty_house.dds"
	major = yes

	ai_check_interval = 120

	desc = liberate_k_ionia_decision_desc

	selection_tooltip = liberate_k_ionia_decision_tooltip

	is_shown = {
		#Must have a culture belonging to the region
		OR = {
			has_culture = culture:dorian
			has_culture = culture:ionian
			has_culture = culture:aeolian
		}

		OR = {
			has_primary_title = title:k_troas
		}

		#Must not already exist or have de jure territory
		title:k_ionia = { 
			is_titular = yes
			is_title_created = no
		}
	}

	is_valid = {
	}

	is_valid_showing_failures_only = {
		is_capable_adult = yes
		is_imprisoned = no
		is_at_war = no
	}

	effect = {
		save_scope_as = ionian_kingdom_founder
		add_character_flag = ionian_kingdom_liberator
		title:k_ionia = { save_scope_as = ionian_kingdom }

		show_as_tooltip = { form_k_ionia_decision_effects = yes } # Actually applied in anatolia_decisions.0003 - prestige, de-jure, title etc
		custom_tooltip = form_k_ionia_decision_effects.de_jure.tt

		#Events
		trigger_event = anatolia_decisions.0003

		#Notify other players
		every_player = {
			limit = {
				NOT = { this = root }
				is_within_diplo_range = { CHARACTER = root }
			}
			trigger_event = anatolia_decisions.0004
		}
	}

	cost = {
		gold = 600
		prestige = 300
	}

	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 100
	}
}

##############################
# k_troas Decisions		 	 #
##############################
# These are identical aside from requirements and flavour
# - form_k_troas_decision
# - liberate_k_troas_decision

form_k_troas_decision = { # aka: Unite the poleis of the Troadic coast
	picture = "gfx/interface/illustrations/decisions/decision_dynasty_house.dds"
	major = yes

	ai_check_interval = 120

	desc = form_k_troas_decision_desc

	selection_tooltip = form_k_troas_decision_tooltip

	is_shown = {
		OR = {
			has_culture = culture:dorian
			has_culture = culture:ionian
			has_culture = culture:aeolian
		}

		capital_province = { geographical_region = custom_troas }

		highest_held_title_tier <= tier_duchy

		#Must not already exist or have de jure territory
		title:k_troas = { 
			is_titular = yes
			is_title_created = no
		}
	}

	is_valid = {
		is_independent_ruler = yes

		#Primary title must be one of the Troadic duchies
		custom_description = {
			text = form_k_troas_decision.primary_duchy.tt
			OR = {
				has_primary_title = title:d_troas
				has_primary_title = title:d_mysia
				has_primary_title = title:d_askania
			}
		}

		#Must have city-state or coalition government
		OR = {
			has_city_state_government = yes
			has_coalition_government = yes
		}

		#Has to control the Hellespontine coast of Asia Minor
		completely_controls_region = custom_troas
	}

	is_valid_showing_failures_only = {
		is_capable_adult = yes
		is_imprisoned = no
		is_at_war = no
	}

	effect = {
		save_scope_as = ionian_kingdom_founder
		title:k_troas = { save_scope_as = ionian_kingdom }

		show_as_tooltip = { form_k_troas_decision_effects = yes } # Actually applied in anatolia_decisions.0003 - prestige, de-jure, title etc
		custom_tooltip = form_k_troas_decision_effects.de_jure.tt

		#Events
		trigger_event = anatolia_decisions.0003

		#Notify other players
		every_player = {
			limit = {
				NOT = { this = root }
				is_within_diplo_range = { CHARACTER = root }
			}
			trigger_event = anatolia_decisions.0004
		}
	}

	cost = {
		gold = 300
	}

	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 100
	}
}

liberate_k_troas_decision = { # aka: Liberate the Troadic coast
	picture = "gfx/interface/illustrations/decisions/decision_dynasty_house.dds"
	major = yes

	ai_check_interval = 120

	desc = liberate_k_troas_decision_desc

	selection_tooltip = liberate_k_troas_decision_tooltip

	is_shown = {
		#Must have a culture belonging to the region
		OR = {
			has_culture = culture:dorian
			has_culture = culture:ionian
			has_culture = culture:aeolian
		}

		OR = {
			has_primary_title = title:k_ionia
		}

		#Must not already exist or have de jure territory
		title:k_ionia = { 
			is_titular = yes
			is_title_created = no
		}
	}

	is_valid = {
		is_independent_ruler = yes

		#Primary title must be one of the liberated kingdoms in the Greater Ionia region
		custom_description = {
			text = liberate_k_troas_decision.primary_kingdom.tt
			OR = {
				has_primary_title = title:k_ionia
			}
		}

		#Must have federal government
		has_federal_government = yes

		#Has to control the Hellespontine coast of Asia Minor
		completely_controls_region = custom_troas
	}

	is_valid_showing_failures_only = {
		is_capable_adult = yes
		is_imprisoned = no
		is_at_war = no
	}

	effect = {
		save_scope_as = ionian_kingdom_founder
		add_character_flag = ionian_kingdom_liberator
		title:k_troas = { save_scope_as = ionian_kingdom }

		show_as_tooltip = { form_k_troas_decision_effects = yes } # Actually applied in anatolia_decisions.0003 - prestige, de-jure, title etc
		custom_tooltip = form_k_troas_decision_effects.de_jure.tt

		#Events
		trigger_event = anatolia_decisions.0003

		#Notify other players
		every_player = {
			limit = {
				NOT = { this = root }
				is_within_diplo_range = { CHARACTER = root }
			}
			trigger_event = anatolia_decisions.0004
		}
	}

	cost = {
		gold = 600
		prestige = 300
	}

	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 100
	}
}